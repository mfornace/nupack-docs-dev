<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://docs.nupack.org/latest/utilities/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Utilities Jobs - NUPACK 4 User Guide</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
        <link href="../css/version-select.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Utilities Jobs";
        var mkdocs_page_input_path = "utilities.md";
        var mkdocs_page_url = "/latest/utilities/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> NUPACK 4 User Guide
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Overview</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../definitions/">Definitions</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../model/">Model Specification</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../analysis/">Analysis Jobs</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../design/">Design Jobs</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Utilities Jobs</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#compute-partition-function">Compute partition function</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#compute-structure-free-energy">Compute structure free energy</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#compute-equilibrium-structure-probability">Compute equilibrium structure probability</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#compute-boltzmann-sampled-structures">Compute Boltzmann-sampled structures</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#compute-equilibrium-base-pairing-probabilities">Compute equilibrium base-pairing probabilities</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#compute-mfe-proxy-structures">Compute MFE proxy structure(s)</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#compute-suboptimal-proxy-structures">Compute suboptimal proxy structures</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#compute-complex-ensemble-size">Compute complex ensemble size</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#design-a-sequence">Design a sequence</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#compute-complex-ensemble-defect">Compute complex ensemble defect</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#represent-a-structure">Represent a structure</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#compute-sequence-distance">Compute sequence distance</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#compute-structure-distance">Compute structure distance</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../start/">Getting Started</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../advanced/">Advanced</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">NUPACK 4 User Guide</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Utilities Jobs</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="utilities-jobs">Utilities Jobs<a class="headerlink" href="#utilities-jobs" title="Permanent link">&para;</a></h1>
<p>Utilities commands analyze or design a single complex ensemble. For each command, the strand ordering of the complex is specified using keyword <code>strands</code> and the <a href="../model/#model-specification">physical model</a> is specified using keyword <code>model</code>.
For commands that require a structure (e.g., calculation of the equilibrium structure probability using <code>prob</code>), the structure is specified using the keyword <code>structure</code>. By default, NUPACK utilities jobs run in <a href="../advanced/#parallelism">parallel</a>.</p>
<p>To initialize a model for the following examples, run the following code:</p>
<div class="highlight"><pre><span></span><code><span class="n">my_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">material</span><span class="o">=</span><span class="s1">&#39;RNA&#39;</span><span class="p">)</span>
</code></pre></div>
<hr />
<h2 id="compute-partition-function">Compute partition function<a class="headerlink" href="#compute-partition-function" title="Permanent link">&para;</a></h2>
<p><code>pfunc</code> calculates the <a href="../definitions/#partition-function">partition function</a> of the complex as well as the free energy of the complex:</p>
<div class="highlight"><pre><span></span><code><span class="n">partition_function</span> <span class="o">=</span> <span class="n">pfunc</span><span class="p">(</span><span class="n">strands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CCC&#39;</span><span class="p">,</span> <span class="s1">&#39;GGG&#39;</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="n">my_model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">partition_function</span><span class="p">)</span>
<span class="c1"># --&gt; (Decimal(&#39;4525.512868&#39;), -5.187871791642832)</span>
</code></pre></div>
<hr />
<h2 id="compute-structure-free-energy">Compute structure free energy<a class="headerlink" href="#compute-structure-free-energy" title="Permanent link">&para;</a></h2>
<p><code>structure_energy</code> calculates the <a href="../definitions/#structure-free-energy">structure free energy</a> for the specified secondary structure:</p>
<div class="highlight"><pre><span></span><code><span class="n">dGstruc</span> <span class="o">=</span> <span class="n">structure_energy</span><span class="p">(</span><span class="n">strands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AAAA&#39;</span><span class="p">,</span> <span class="s1">&#39;UUUU&#39;</span><span class="p">],</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;((((+))))&#39;</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">my_model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dGstruc</span><span class="p">)</span>
<span class="c1"># --&gt; -0.18135141907945873</span>
</code></pre></div>
<hr />
<h2 id="compute-equilibrium-structure-probability">Compute equilibrium structure probability<a class="headerlink" href="#compute-equilibrium-structure-probability" title="Permanent link">&para;</a></h2>
<p><code>structure_probability</code> calculates the <a href="../definitions/#equilibrium-structure-probability">equilibrium structure probability</a> of a specified secondary structure contained in the complex ensemble:</p>
<div class="highlight"><pre><span></span><code><span class="n">probability</span> <span class="o">=</span> <span class="n">structure_probability</span><span class="p">(</span><span class="n">strands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CCC&#39;</span><span class="p">,</span> <span class="s1">&#39;GGG&#39;</span><span class="p">],</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;(((+)))&#39;</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">my_model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">probability</span><span class="p">)</span>
<span class="c1"># --&gt; 0.7152766753194949</span>
</code></pre></div>
<hr />
<h2 id="compute-boltzmann-sampled-structures">Compute Boltzmann-sampled structures<a class="headerlink" href="#compute-boltzmann-sampled-structures" title="Permanent link">&para;</a></h2>
<p><code>sample</code> calculates a set of <a href="../definitions/#boltzmann-sampled-structures">Boltzmann-sampled structures</a> from the complex ensemble. The number of structures is specified using the keyword <code>num_sample</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">sampled_structures</span> <span class="o">=</span> <span class="n">sample</span><span class="p">(</span><span class="n">strands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CCC&#39;</span><span class="p">,</span> <span class="s1">&#39;GGG&#39;</span><span class="p">],</span> <span class="n">num_sample</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">my_model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sampled_structures</span><span class="p">)</span>
<span class="c1"># --&gt; [Structure(&#39;(((+)))&#39;), Structure(&#39;(((+)))&#39;), Structure(&#39;(((+)))&#39;)]</span>
</code></pre></div>
<hr />
<h2 id="compute-equilibrium-base-pairing-probabilities">Compute equilibrium base-pairing probabilities<a class="headerlink" href="#compute-equilibrium-base-pairing-probabilities" title="Permanent link">&para;</a></h2>
<p><code>pairs</code> calculates the matrix of <a href="../definitions/#equilibrium-base-pairing-probabilities">equilibrium base-pairing probabilities</a>:</p>
<div class="highlight"><pre><span></span><code><span class="n">probability_matrix</span> <span class="o">=</span> <span class="n">pairs</span><span class="p">(</span><span class="n">strands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CCC&#39;</span><span class="p">,</span> <span class="s1">&#39;GGG&#39;</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="n">my_model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">probability_matrix</span><span class="p">)</span>
<span class="c1"># --&gt;</span>
<span class="c1"># [[0.1002 0.0000 0.0000 0.0007 0.1474 0.7518]</span>
<span class="c1">#  [0.0000 0.0037 0.0000 0.1474 0.8307 0.0182]</span>
<span class="c1">#  [0.0000 0.0000 0.1904 0.7910 0.0185 0.0001]</span>
<span class="c1">#  [0.0007 0.1474 0.7910 0.0609 0.0000 0.0000]</span>
<span class="c1">#  [0.1474 0.8307 0.0185 0.0000 0.0035 0.0000]</span>
<span class="c1">#  [0.7518 0.0182 0.0001 0.0000 0.0000 0.2299]]</span>
</code></pre></div>
<p>(Convert the result to a numpy array via <code>probability_matrix.to_array()</code>.)</p>
<h2 id="compute-mfe-proxy-structures">Compute MFE proxy structure(s)<a class="headerlink" href="#compute-mfe-proxy-structures" title="Permanent link">&para;</a></h2>
<p><code>mfe</code> calculates <a href="../definitions/#mfe-proxy-structure">MFE proxy structure</a>. The algorithm returns the MFE proxy secondary structure, the free energy of the MFE stacking state, and the free energy of the MFE proxy secondary structure:</p>
<div class="highlight"><pre><span></span><code><span class="n">mfe_structures</span> <span class="o">=</span> <span class="n">mfe</span><span class="p">(</span><span class="n">strands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CCC&#39;</span><span class="p">,</span> <span class="s1">&#39;GGG&#39;</span><span class="p">],</span> <span class="n">model</span><span class="o">=</span><span class="n">my_model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Free energy of MFE proxy structure: </span><span class="si">%.2f</span><span class="s1"> kcal/mol&#39;</span> <span class="o">%</span> <span class="n">mfe_structures</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">energy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MFE proxy structure in dot-parens-plus notation: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mfe_structures</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">structure</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;MFE proxy structure as structure matrix:</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mfe_structures</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">matrix</span><span class="p">())</span>
</code></pre></div>
<p>Output:</p>
<div class="highlight"><pre><span></span><code>Free energy of MFE proxy structure: -4.98 kcal/mol
MFE proxy structure in dot-parens-plus notation: (((+)))
MFE proxy structure as structure matrix:
[[0 0 0 0 0 1]
 [0 0 0 0 1 0]
 [0 0 0 1 0 0]
 [0 0 1 0 0 0]
 [0 1 0 0 0 0]
 [1 0 0 0 0 0]]
</code></pre></div>
<p>If there is more than one MFE stacking state, the algorithm returns a list of the corresponding MFE proxy secondary structures, each with the free energy of the MFE proxy secondary structure and the (same) free energy of the MFE stacking state.</p>
<hr />
<h2 id="compute-suboptimal-proxy-structures">Compute suboptimal proxy structures<a class="headerlink" href="#compute-suboptimal-proxy-structures" title="Permanent link">&para;</a></h2>
<p><code>subopt</code> calculates the set of <a href="../definitions/#suboptimal-proxy-structures">suboptimal proxy structures</a> with a stacking state within a specified free energy gap of the MFE stacking state. The (non-negative) free energy gap is specified with keyword <code>energy_gap</code> in kcal/mol. The algorithm returns a list of suboptimal proxy secondary strutures, each with the free energy of the suboptimal proxy secondary structure and with the free energy of its lowest-energy stacking state that falls within the energy gap:</p>
<div class="highlight"><pre><span></span><code><span class="n">subopt_structures</span> <span class="o">=</span> <span class="n">subopt</span><span class="p">(</span><span class="n">strands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CCC&#39;</span><span class="p">,</span> <span class="s1">&#39;GGG&#39;</span><span class="p">],</span> <span class="n">energy_gap</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">my_model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">subopt_structures</span><span class="p">)</span>
<span class="c1"># --&gt; [StructureEnergy(Structure(&#39;(((+)))&#39;), energy=-4.981351375579834, stack_energy=-4.981351375579834),</span>
<span class="c1">#      StructureEnergy(Structure(&#39;((.+)).&#39;), energy=-4.000725746154785, stack_energy=-3.781351089477539)]</span>
</code></pre></div>
<hr />
<h2 id="compute-complex-ensemble-size">Compute complex ensemble size<a class="headerlink" href="#compute-complex-ensemble-size" title="Permanent link">&para;</a></h2>
<p><code>ensemble_size</code> calculates the <a href="../definitions/#complex-ensemble-size">complex ensemble size</a> in terms of either number of secondary structures or number of stacking states. Specify a <a href="../model/#model-specification">physical model</a> with <code>nostacking</code> to obtain the number of secondary structures:</p>
<div class="highlight"><pre><span></span><code><span class="n">num_struc</span> <span class="o">=</span> <span class="n">ensemble_size</span><span class="p">(</span><span class="n">strands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CCC&#39;</span><span class="p">,</span> <span class="s1">&#39;GGG&#39;</span><span class="p">],</span>
    <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="p">(</span><span class="n">material</span><span class="o">=</span><span class="s1">&#39;RNA&#39;</span><span class="p">,</span> <span class="n">ensemble</span><span class="o">=</span><span class="s1">&#39;nostacking&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">num_struc</span><span class="p">)</span>
<span class="c1"># --&gt; 18</span>
</code></pre></div>
<p>Specify a physical model with <code>stacking</code> to obtain the number of stacking states:</p>
<div class="highlight"><pre><span></span><code><span class="n">num_stack</span> <span class="o">=</span> <span class="n">ensemble_size</span><span class="p">(</span><span class="n">strands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CCC&#39;</span><span class="p">,</span> <span class="s1">&#39;GGG&#39;</span><span class="p">],</span>
    <span class="n">model</span><span class="o">=</span><span class="n">Model</span><span class="p">(</span><span class="n">material</span><span class="o">=</span><span class="s1">&#39;RNA&#39;</span><span class="p">,</span> <span class="n">ensemble</span><span class="o">=</span><span class="s1">&#39;stacking&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">num_stack</span><span class="p">)</span>
<span class="c1"># --&gt; 90</span>
</code></pre></div>
<hr />
<h2 id="design-a-sequence">Design a sequence<a class="headerlink" href="#design-a-sequence" title="Permanent link">&para;</a></h2>
<p><code>des</code> performs complex design to generate a sequence intended to adopt a target secondary structure at equilibrium within the ensemble of the complex. The strand ordering of the complex can be specified using IUPAC <a href="../definitions/#degenerate-nucleotide-codes">degenerate nucleotide codes</a> to incorporate any sequence constraints (the strand ordering can be omitted if there are no sequence constraints). The target structure is specified using keyword <code>structure</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># design a sequence without sequence constraints</span>
<span class="n">designed_sequence1</span> <span class="o">=</span> <span class="n">des</span><span class="p">(</span><span class="n">structure</span><span class="o">=</span><span class="s1">&#39;(((+)))&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">my_model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">designed_sequence1</span><span class="p">)</span>
<span class="c1"># --&gt; [&#39;GGC&#39;, &#39;GCC&#39;]</span>

<span class="c1"># alternative specification to design a sequence without sequence constraints</span>
<span class="n">designed_sequence1</span> <span class="o">=</span> <span class="n">des</span><span class="p">(</span><span class="n">strands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;NNN&#39;</span><span class="p">,</span><span class="s1">&#39;NNN&#39;</span><span class="p">],</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;(((+)))&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">my_model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">designed_sequence1</span><span class="p">)</span>
<span class="c1"># --&gt; [&#39;GGC&#39;, &#39;GCC&#39;]</span>

<span class="c1"># design a sequence with sequence constraints</span>
<span class="n">designed_sequence2</span> <span class="o">=</span> <span class="n">des</span><span class="p">(</span><span class="n">strands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;HHH&#39;</span><span class="p">,</span><span class="s1">&#39;BBW&#39;</span><span class="p">],</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;(((+)))&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">my_model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">designed_sequence2</span><span class="p">)</span>
<span class="c1"># --&gt; [&#39;ACC&#39;, &#39;GGU&#39;]</span>
</code></pre></div>
<hr />
<h2 id="compute-complex-ensemble-defect">Compute complex ensemble defect<a class="headerlink" href="#compute-complex-ensemble-defect" title="Permanent link">&para;</a></h2>
<p><code>defect</code> evaluates the normalized <a href="../definitions/#complex-ensemble-defect">complex ensemble defect</a> with respect to the structure specified using keyword <code>structure</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">ensemble_defect</span> <span class="o">=</span> <span class="n">defect</span><span class="p">(</span><span class="n">strands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CCC&#39;</span><span class="p">,</span> <span class="s1">&#39;GGG&#39;</span><span class="p">],</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;(((+)))&#39;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">my_model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ensemble_defect</span><span class="p">)</span>
<span class="c1"># --&gt; 0.20883411169052118</span>
</code></pre></div>
<hr />
<h2 id="represent-a-structure">Represent a structure<a class="headerlink" href="#represent-a-structure" title="Permanent link">&para;</a></h2>
<p>A <a href="../definitions/#secondary-structure">secondary structure</a> can be defined using any of three notations (keyword <code>Structure</code>):</p>
<div class="highlight"><pre><span></span><code><span class="n">s1</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span><span class="s1">&#39;((((((((((((+..........))))))))))))&#39;</span><span class="p">)</span> <span class="c1"># dot-parens-plus notation</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span><span class="s1">&#39;(12+.10)12&#39;</span><span class="p">)</span> <span class="c1"># run-length-encoded dot-parens-plus notation</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span><span class="s1">&#39;D12 (+ U10)&#39;</span><span class="p">)</span> <span class="c1"># DU+ notation</span>
</code></pre></div>
<p>Any object or command that accepts a structure as an argument (e.g, <code>TargetComplex</code> in Design or <code>structure_probability</code> in Utilities) will accept either a structure defined in one of the above three notations, or a previously defined <code>Structure</code> object:</p>
<div class="highlight"><pre><span></span><code><span class="n">dGstruc</span> <span class="o">=</span> <span class="n">structure_energy</span><span class="p">(</span><span class="n">strands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AAAA&#39;</span><span class="p">,</span> <span class="s1">&#39;TTTT&#39;</span><span class="p">],</span> <span class="n">structure</span><span class="o">=</span><span class="s1">&#39;((((+))))&#39;</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">my_model</span><span class="p">)</span>

<span class="n">my_struc</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span><span class="s1">&#39;((((+))))&#39;</span><span class="p">)</span>
<span class="n">dGstruc</span> <span class="o">=</span> <span class="n">structure_energy</span><span class="p">(</span><span class="n">strands</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;AAAA&#39;</span><span class="p">,</span> <span class="s1">&#39;TTTT&#39;</span><span class="p">],</span> <span class="n">structure</span><span class="o">=</span><span class="n">my_struc</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">my_model</span><span class="p">)</span>
</code></pre></div>
<p><code>Structure</code> supports the following methods to assist with structure representation:</p>
<ul>
<li><code>pairlist()</code>: A pair list contains a list <span class="arithmatex"><span class="MathJax_Preview">S</span><script type="math/tex">S</script></span> of zero-based indices such that <span class="arithmatex"><span class="MathJax_Preview">S_i = j</span><script type="math/tex">S_i = j</script></span> if bases <span class="arithmatex"><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span> and <span class="arithmatex"><span class="MathJax_Preview">j</span><script type="math/tex">j</script></span> are paired, and <span class="arithmatex"><span class="MathJax_Preview">S_i = i</span><script type="math/tex">S_i = i</script></span> if base <span class="arithmatex"><span class="MathJax_Preview">i</span><script type="math/tex">i</script></span> is unpaired.</li>
<li><code>matrix()</code>: A <a href="../definitions/#secondary-structure">structure matrix</a> of the structure.</li>
<li><code>nicks()</code>: A list of zero-based indices of each base 3<span class="arithmatex"><span class="MathJax_Preview">'</span><script type="math/tex">'</script></span> of a nick between strands (one entry per strand)</li>
<li><code>dotparensplus()</code>: Representation of the structure in dot-parens-plus notation.</li>
<li><code>rle_dotparensplus()</code>: Representation of the structure in run-length-encoded dot-parens-plus notation.</li>
</ul>
<p>For example:</p>
<div class="highlight"><pre><span></span><code><span class="n">s4</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span><span class="s1">&#39;(((+))).&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">s4</span><span class="o">.</span><span class="n">pairlist</span><span class="p">())</span>          <span class="c1"># --&gt; [5 4 3 2 1 0 6]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">s4</span><span class="o">.</span><span class="n">matrix</span><span class="p">())</span>            <span class="c1"># --&gt; [[0 0 0 0 0 1 0]</span>
                              <span class="c1">#      [0 0 0 0 1 0 0]</span>
                              <span class="c1">#      [0 0 0 1 0 0 0]</span>
                              <span class="c1">#      [0 0 1 0 0 0 0]</span>
                              <span class="c1">#      [0 1 0 0 0 0 0]</span>
                              <span class="c1">#      [1 0 0 0 0 0 0]</span>
                              <span class="c1">#      [0 0 0 0 0 0 1]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s4</span><span class="o">.</span><span class="n">nicks</span><span class="p">())</span>             <span class="c1"># --&gt; [3 7]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s4</span><span class="o">.</span><span class="n">dotparensplus</span><span class="p">())</span>     <span class="c1"># --&gt; (((+))).</span>
<span class="nb">print</span><span class="p">(</span><span class="n">s4</span><span class="o">.</span><span class="n">rle_dotparensplus</span><span class="p">())</span> <span class="c1"># --&gt; (3+)3.</span>
</code></pre></div>
<h2 id="compute-sequence-distance">Compute sequence distance<a class="headerlink" href="#compute-sequence-distance" title="Permanent link">&para;</a></h2>
<p><code>seq_distance</code> calculates the <a href="../definitions/#secondary-structure">sequence distance</a> for two sequences that have the same number of nucleotides:</p>
<div class="highlight"><pre><span></span><code><span class="n">seq_distance</span><span class="p">(</span><span class="s1">&#39;ACGUUUU+ACCC&#39;</span><span class="p">,</span><span class="s1">&#39;ACGUUUU+AGGG&#39;</span><span class="p">)</span> <span class="c1"># --&gt; 3</span>

<span class="n">seq_distance</span><span class="p">(</span><span class="s1">&#39;G5&#39;</span><span class="p">,</span> <span class="s1">&#39;G3C2&#39;</span><span class="p">)</span> <span class="c1"># --&gt; 2</span>
</code></pre></div>
<h2 id="compute-structure-distance">Compute structure distance<a class="headerlink" href="#compute-structure-distance" title="Permanent link">&para;</a></h2>
<p><code>struc_distance</code> calculates the <a href="../definitions/#secondary-structure">structure distance</a> for two structures that have the same number of nucleotides:</p>
<div class="highlight"><pre><span></span><code><span class="n">struc_distance</span><span class="p">(</span><span class="s1">&#39;((((((((+..........))))))))&#39;</span><span class="p">,</span> <span class="s1">&#39;(((((((.+...........)))))))&#39;</span><span class="p">)</span> <span class="c1"># --&gt; 2</span>

<span class="n">struc_distance</span><span class="p">(</span><span class="s1">&#39;.15&#39;</span><span class="p">,</span> <span class="s1">&#39;(5.5)5&#39;</span><span class="p">)</span> <span class="c1"># --&gt; 10</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that <a href="../definitions/#sequence">sequence distance</a> and <a href="../definitions/#secondary-structure">structure distance</a> are defined independent of whether the nick locations match between two sequences or two structures. However, <code>seq_distance</code> and <code>struc_distance</code> will return a warning if the nick locations do not match.</p>
</div>
<div class="references"></div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../design/" class="btn btn-neutral float-left" title="Design Jobs"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../start/" class="btn btn-neutral float-right" title="Getting Started">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="http://nupack.org/" class="fa fa-code-fork" style="color: #fcfcfc"> Nupack</a>
        </span>
    
    
      <span><a href="../design/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../start/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      <script src="../search/main.js"></script>
      <script src="../js/version-select.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
